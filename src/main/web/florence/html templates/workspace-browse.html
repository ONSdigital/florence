<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Workspace</title>
    <link rel="stylesheet" type="text/css" href="../css/style.min.css">
</head>
<body>
	<div class="wrapper">
		<nav>
			<ul class="nav">
				<li class="selected">Working on: Collection name goes here</li>
				<li>Collections</li>
				<li>Users and access</li>
				<li>Publish</li>
				<li>My account</li>
			</ul>
		</nav>
		<nav class="panel col col--1 workspace-nav">
			<ul class="nav nav--workspace">
				<li class="selected">Browse</li>
				<li>Create</li>
				<li>Edit</li>
				<li>Review</li>
			</ul>
		</nav>
		<section class="panel col col--4 workspace-browse">
			<nav class="tree-nav-holder">
				<ul class="page-list page-list--tree">
					<li data-url="">
						<span class="page-item">Home</span>
						<div class="page-options">
							<button class="">Button</button>
							<button class="">Button</button>
							<button class="">Button</button>
						</div>
						<ul>
							<li data-url="businessindustryandtrade">
							<span class="page-item">Business and trade</span>
								<div class="page-options">
									<button class="">Button</button>
									<button class="">Button</button>
									<button class="">Button</button>
								</div>
								<ul>
									<li data-url="businessindustryandtrade/retailindustry">
									<span class="page-item">Retail industry</span>
										<div class="page-options">
											<button class="">Button</button>
											<button class="">Button</button>
											<button class="">Button</button>
										</div>
									</li>
									<li>
									<span class="page-item">t1 - 1 | t2 - 2</span>
										<div class="page-options">
											<button class="">Button</button>
											<button class="">Button</button>
											<button class="">Button</button>
										</div>
										<ul>
											<li>
											<span class="page-item">t1 - 1 | t2 - 2 | t3 - 1</span>
												<div class="page-options">
													<button class="">Button</button>
													<button class="">Button</button>
													<button class="">Button</button>
												</div>
											</li>
											<li>
											<span class="page-item">t1 - 1 | t2 - 2 | t3 - 2</span>
												<div class="page-options">
													<button class="">Button</button>
													<button class="">Button</button>
													<button class="">Button</button>
												</div>
											</li>
										</ul>
									</li>
									<li>
									<span class="page-item">t1 - 1 | t2 - 3</span>
										<div class="page-options">
											<button class="">Button</button>
											<button class="">Button</button>
											<button class="">Button</button>
										</div>
									</li>
								</ul>
							</li>
							<li data-url="economy">
							<span class="page-item">Economy</span>
								<div class="page-options">
									<button class="">Button</button>
									<button class="">Button</button>
									<button class="">Button</button>
								</div>
							</li>
							<li>
							<span class="page-item">t1 - 3</span>
								<div class="page-options">
									<button class="">Button</button>
									<button class="">Button</button>
									<button class="">Button</button>
								</div>
							</li>
							<li>
							<span class="page-item">t1 - 4</span>
								<div class="page-options">
									<button class="">Button</button>
									<button class="">Button</button>
									<button class="">Button</button>
								</div>
							</li>
							<li>
							<span class="page-item">t1 - 5</span>
								<div class="page-options">
									<button class="">Button</button>
									<button class="">Button</button>
									<button class="">Button</button>
								</div>
							</li>
							<li>
							<span class="page-item">t1 - 6</span>
								<div class="page-options">
									<button class="">Button</button>
									<button class="">Button</button>
									<button class="">Button</button>
								</div>
							</li>
						</ul>
					</li>
				</ul>
			</nav>
		</section>
		<section class="panel col col--7 workspace-browser">
			<div class="browser">
				<div class="addressbar">
					<button class="browser-btn-back">&lt;</button>
					<button class="browser-btn-forward">&gt;</button>
					<label for="browser-location" class="browser-location-label">Preview URL</label><input id="browser-location" class="browser-location" type="text" value="">
					<button class="browser-btn-mobile">Mobile</button>
				</div>
				<iframe id="iframe" src="http://localhost:8081/index.html#!/"></iframe>
			</div>
		</section>
	</div>
	<script type="text/javascript" src="../js/jquery.min.js"></script>
	<!-- <script type="text/javascript" src="../js/main.js"></script> -->
	<!-- <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->


	<script type="text/javascript">
	$(document).ready(function(){

			//page-list
			$('.page-item').click(function(){
				$('.page-list li').removeClass('selected');
				$('.page-options').hide();

				$(this).parent('li').addClass('selected');
				// $(this).addClass('page-item--selected');
				$(this).next('.page-options').show();

				//page-list-tree
				$('.tree-nav-holder ul').removeClass('active');
				$(this).parents('ul').addClass('active');
				$(this).closest('li').children('ul').addClass('active');
			});

			// function pageListItemSelect(caller){
			// 	//
			// }

			$('.page-list--tree .page-item').click(function(){
				//change iframe location
				var newURL = baseURL + $(this).closest('li').attr('data-url');
				browserContent.document.location.href = newURL;
				$('.browser-location').val(newURL);
				// console.log(newURL);
			});


			function treeNodeSelect(url){
				var urlPart = url.replace('baseURL', '');
				var selectedListItem = $('.tree-nav-holder li').find('[data-url="' + urlPart + '"]'); //get first li with data-url with url

				console.log(selectedListItem);

				$('.page-list li').removeClass('selected');
				$('.page-options').hide();

				$(selectedListItem).addClass('selected hello');
				$(selectedListItem).next('.page-options').show();

				//page-list-tree
				$('.tree-nav-holder ul').removeClass('active');
				$(selectedListItem).parents('ul').addClass('active');
				$(selectedListItem).closest('li').children('ul').addClass('active');
			}



			//mini browser
			var baseURL = 'http://localhost:8081/index.html#!/';
			var browserContent = $('#iframe')[0].contentWindow;
			browserContent.document.onclick = function(){
				var browserLocation = browserContent.location.href;
				$('.browser-location').val(browserLocation);
				//treeNodeSelect(browserLocation);
				//console.log(browserLocation);
				// console.log('iframe inner clicked');
			};

			$('.browser-location').val($('#iframe').attr('src'));

			//disabled back and forward buttons (display: none in css) for now (bugs - one click behind)
			// $('.browser-btn-back').click(function(){
			// 	browserContent.history.back();
			// 	var browserLocation = browserContent.location.href;
			// 	// console.log(browserContent.history.back(Window));
			// 	$('.browser-location').val(browserLocation);
			// });

			// $('.browser-btn-forward').click(function(){
			// 	browserContent.history.forward();
			// 	var browserLocation = browserContent.location.href;
			// 	$('.browser-location').val(browserLocation);
			// });

			
	});
	</script>
</body>
</html>